\subsection{Biblioteca}
A biblioteca usada pelos clientes para comunicar com o sistema de memória distribuída encontra-se representada na classe \textit{Library}. Esta classe tem a seguinte estrutura:

\begin{table}[H]
\centering
\begin{tabular}{| p{2cm} | p{5,5cm} |}
\hline
\textbf{Variável} & \textbf{Descrição} \\
\hline
Master server & Referência para o \textit{Master}  \\
\hline
Actual tid & Identificador da transacção atribuído pelo \textit{Master} \\
\hline
Cache & Cache usada para guardar os valores temporários dos \textit{PadInt}s \\
\hline
Channel & Canal usado pela biblioteca \\
\hline
\end{tabular}
\caption{Atributos da classe Library} \label{lib}
\end{table}

De seguida apresentam-se alguns métodos da Biblioteca:
\begin{itemize}
\item \textit{bool init()}: cria o canal a ser usado pela \textit{Library} e inicializa a variável master server. Quando o canal é criado é também definido um valor de \textit{timeout} ao fim do qual a \textit{Library} deixa de estar bloqueada à espera de resposta a pedido que efectuou;

\item \textit{bool TxBegin()}: a Biblioteca pede ao Master para criar um novo \textit{TID} para a transacção e regista-o. É criada uma nova \textit{Cache};

\item \textit{bool TxCommit()}: descrito na secção \ref{commit};

\item \textit{bool TxAbort()}:descrito na secção \ref{abort};

\item \textit{PadInt CreatePadInt(int UID)}: a \textit{Library} pede ao \textit{Master} para registar o \textit{PadInt} e se este não tiver já sido registado anteriormente o \textit{Master} retorna um tuplo contendo o identificador e endereço do \textit{Server} onde esse \textit{PadInt} deverá ser criado. De seguida, o \textit{Server} primário, em resposta ao pedido da \textit{Library}, cria um \textit{PadInt} inicializado a zero, sem \textit{locks} e pede ao secundário para fazer o mesmo, só respondendo à \textit{Library}, com um \textit{ack}, depois de ter recebido o \textit{ack} do secundário. Por fim, a \textit{Library} insere o \textit{PadIntRegistry}, relativo ao \textit{PadInt}, na cache, criando de seguida o \textit{Stub} do \textit{PadInt} para retornar ao cliente;

\item \textit{PadInt AccessPadInt(int UID)}: a \textit{Library} pergunta ao \textit{Master} qual é o \textit{Server} onde está o \textit{PadInt}. Caso o \textit{PadInt} exista,  o \textit{Master} retorna um tuplo contendo o identificador e endereço do \textit{Server} onde esse \textit{PadInt} se encontra. De seguida a \textit{Library} pergunta ao \textit{Server} se tem o \textit{PadInt}. Caso a resposta seja afirmativa, a \textit{Library} insere o \textit{PadIntRegistry}, relativo ao \textit{PadInt}, na cache,  e retorna ao cliente uma nova instância do \textit{Stub} do \textit{PadInt}. Caso contrário é lançada uma excepção;
\end{itemize}

\subsubsection{Cache}
\label{cache}
Com o objectivo de melhorar o desempenho relativo a leituras e escritas criámos a classe \textit{Cache}. Esta classe permite guardar valores temporários relativos a cada \textit{PadInt} usado pelo cliente. A ideia base do funcionamento das leituras e escritas usando a \textit{Cache} foi já descrita anteriormente na secção \ref{Stub do PadInt}. Para tornar definitivos os valores escritos na \textit{Cache} antes de ser efectuado o \textit{commit}, descrito na secção \ref{commit}, todos os \textit{PadInt} acedidos para escrita são escritos no \textit{Server} que os armazena.

Uma das vantagens obtidas com o uso da \textit{Cache} é que se reduz drasticamente o número de pedidos efectuados ao \textit{Server}, reduzindo assim a carga a que este está sujeito. Outra vantagem é reduzir o tempo consumido nas transações, pois as leituras e escritas são mais rápidas devido a serem realizadas localmente.